<?xml version="1.0" encoding="utf-8" ?>
<Defs>
<!-- AbilityGroupe = Ritual Cooldown -->
	<AbilityGroupDef>
		<defName>TheoryResearchAbility</defName>
		<cooldownTicks>50000</cooldownTicks>
		<ritualRoleIds>
			<li>TheoryResearcher</li>
		</ritualRoleIds>
	</AbilityGroupDef>

<!-- Precept - Hidden and alway on ResearchSampleBench -->	
	<PreceptDef>
		<defName>TheoryResearchPrecept</defName>
		<label>Theory Research (Simple).</label>
		
		<iconPath>Icons/TheorySimple_Icon</iconPath>
		<ritualPatternBase>TheoryResearchPattern</ritualPatternBase>
		<useCooldownFromAbilityGroupDef>TheoryResearchAbility</useCooldownFromAbilityGroupDef>
		<issue>Ritual</issue>
		<preceptClass>Precept_Ritual</preceptClass>
		<visible>false</visible>
		<classic>true</classic>
		<showRitualFloatMenuOption>false</showRitualFloatMenuOption>
		<useRepeatPenalty>false</useRepeatPenalty>
		<usesIdeoVisualEffects>false</usesIdeoVisualEffects>
		<mergeRitualGizmosFromAllIdeos>true</mergeRitualGizmosFromAllIdeos>
		<countsTowardsPreceptLimit>false</countsTowardsPreceptLimit>
		<selectionWeight>1.0</selectionWeight>
		<notifyPlayerOnOpportunity>true</notifyPlayerOnOpportunity>
	</PreceptDef>
	
<!-- Ritual Target Filter - Where to start the ritual -->		
  	<RitualObligationTargetFilterDef>
		<defName>TheoryResearchFilter</defName>
		<workerClass>TPRitualAttachableOutcomes.RitualObligationTargetWorker_Custom</workerClass>
		<modExtensions>
			<li Class="TPRitualAttachableOutcomes.TargetFilter_ModExtension">
				<extraCandidates>
					<li>SimpleResearchBench</li>
					<li>RGK_SimpleResearchBench</li>
					<li>RR_ThinkingSpot</li>
				</extraCandidates>
			</li>
		</modExtensions>
	</RitualObligationTargetFilterDef>
			
<!-- Ritual Pattern -->
	<RitualPatternDef>
		<defName>TheoryResearchPattern</defName>
<!-- 		<ritualExpectedDesc>Simple theory research is available.</ritualExpectedDesc>
		<ritualExpectedDescNoAdjective>Simple theory research is available.</ritualExpectedDescNoAdjective> -->
		<descOverride>Do simple Theory Research to develop research theories to make theory papers, which you can combine with samples at the sample bench to create research papers required for doing simple research.</descOverride>
		<ritualOnlyForIdeoMembers>false</ritualOnlyForIdeoMembers>
		<ritualObligationTargetFilter>TheoryResearchFilter</ritualObligationTargetFilter>
<!--  		<ritualObligationTriggers>
			<li Class="RitualObligationTrigger_DateProperties">
				<mustBePlayerIdeo>true</mustBePlayerIdeo>
			</li>
		</ritualObligationTriggers> -->
		<ritualBehavior>TheoryResearchBehavior</ritualBehavior>
		<ritualOutcomeEffect>TheoryResearchOutcome</ritualOutcomeEffect>
		<playsIdeoMusic>false</playsIdeoMusic>
		<alwaysStartAnytime>true</alwaysStartAnytime>
		<allowOtherInstances>false</allowOtherInstances>
	</RitualPatternDef>
 
<!-- Ritual Behavior --> 
	<RitualBehaviorDef>
		<defName>TheoryResearchBehavior</defName>
		<durationTicks>3500</durationTicks>
  		<spectatorsLabel>-</spectatorsLabel>
		<spectatorGerund>-</spectatorGerund>
		
 		<roles>
			<li Class="RitualRoleColonist">
				<label>Researcher</label>
				<id>TheoryResearcher</id>
				<required>true</required>
				<requiredWorkType>Research</requiredWorkType>
				<usedSkill>Intellectual</usedSkill>
				<substitutable>true</substitutable>
				<maxCount>1</maxCount>
				<countsAsParticipant>true</countsAsParticipant>
				<allowChild>false</allowChild>
				<mustBeAbleToReachTarget>true</mustBeAbleToReachTarget>
				<blocksSocialInteraction>true</blocksSocialInteraction>
			</li>
		</roles>

<!-- Custom C# Class - Made by: Elouan. -->		
		<spectatorFilter Class = "CustomSpectatorFilter.RitualSpectatorFilter_Custom">
			<description>Spectators cannot contribute.</description>
			<minSkills>
		   <!-- <li> 
					<key>Intellectual</key> <value>30</value> 
				</li> -->
                <!-- You can add few Skills requirement with this template, It work like a "and"--> 
			</minSkills> <!-- If you keep minSkills blank, the class will reject every spectators -->
		</spectatorFilter>
		
		<stages>
			<li>
 			<defaultDuty>Spectate</defaultDuty>
			<allowedSpectateSidesOverride>Vertical</allowedSpectateSidesOverride>
			<spectateDistanceOverride>1</spectateDistanceOverride>
				<spectatorsRequired>false</spectatorsRequired>
				<endTriggers>
					<li Class="StageEndTrigger_DurationPercentage">
						<percentage>1</percentage>
					</li>
				</endTriggers>
				<roleBehaviors>
					<li>
						<roleId>TheoryResearcher</roleId>
						<dutyDef>SpeakOnCell_Leader</dutyDef>
						<speakerInteraction>Speech_Leader</speakerInteraction>
						<customPositions>
							<li Class="RitualPosition_OnInteractionCell" />
						</customPositions>
					</li>
				</roleBehaviors>
				<visualEffectDef>Speech</visualEffectDef>
			</li>
		</stages>
	</RitualBehaviorDef>
  
<!-- Ritual Outcome --> 
	<RitualOutcomeEffectDef>
		<defName>TheoryResearchOutcome</defName>
		<workerClass>TPRitualAttachableOutcomes.RitualOutcomeEffectWorker_FromQuality_TP_Custom</workerClass>
		<allowAttachableOutcome>false</allowAttachableOutcome>
		<givesDevelopmentPoints>false</givesDevelopmentPoints>
		<comps>
			<li Class="RitualOutcomeComp_BuildingOfDefUsed">
				<def>ResearchSampleBench</def>
				<qualityOffset>0.25</qualityOffset>
			</li>
			<li Class="RitualOutcomeComp_Indoors">
				<label>indoors</label>
				<qualityOffset>0.15</qualityOffset>
			</li>
			<li Class="RitualOutcomeComp_RoomStat">
				<label>room cleanliness</label>
				<statDef>Cleanliness</statDef>
				<curve>
					<points>
						<li>0,  0</li>
						<li>0.6, 0.10</li>
					</points>
				</curve>
			</li>
			<li Class="RitualOutcomeComp_PawnSkill">
				<label>{PAWN_labelShort}'s INT skill (Max:10)</label>
				<labelAbstract>researcher's INT skill (Max:10)</labelAbstract>
				<roleId>TheoryResearcher</roleId>
				<skillDef>Intellectual</skillDef>
				<curve>
					<points>
						<li>(0, 0.0)</li>
						<li>(10, 0.50)</li>
					</points>
				</curve>
			</li>
	  <!-- 	<li Class="RitualOutcomeComp_ParticipantCount">
				<label>Participant count</label>
 				<curve>
				  <points>
					<li>(1,  0.0)</li>
					<li>(2,  0.0)</li>
					<li>(3,  0.0)</li>
				  </points>
				</curve>
		    </li> -->
		</comps>
		<outcomeChances>
		    <li>
				<label>Failed</label>
				<chance>0.10</chance>
				<memory>FailedTheory</memory>
				<description>The {0} failed! \n\n0 Theory papers were made.</description>
				<positivityIndex>-1</positivityIndex>
		    </li>
		    <li>
				<label>Satisfying</label>
				<chance>0.60</chance>
				<memory>SatisfyingTheory</memory>
				<description>The {0} was Satisfying! \n\n1 Theory paper was made.</description>
				<positivityIndex>0</positivityIndex>
		    </li>
		    <li>
				<label>Outstanding</label>
				<chance>0.25</chance>
				<memory>OutstandingTheory</memory>
				<description>The {0} was Outstanding! \n\n2 Theory papers were made. \nYou gained theory inspiration, +15% to research for 12 hours.</description>
				<positivityIndex>1</positivityIndex>
		    </li>
		    <li>
				<label>Brilliant</label>
				<chance>0.05</chance>
				<memory>BrilliantTheory</memory>
				<description>The {0} was Brilliant! \n\n3 Theory papers were made. \nYou gained theory inspiration, +15% to research for 12 hours.</description>
				<positivityIndex>2</positivityIndex>
		    </li>
		</outcomeChances>
		<modExtensions>
			<li Class="TPRitualAttachableOutcomes.RitualAttachableOutcomeEffectDef_TP_Custom">
				<node>
					<li Class="TPRitualAttachableOutcomes.RitualAttachableOutcomeEffectDef_TP_Custom_Node">
						<triggerPositivityIndex>
							<li>0</li>
						</triggerPositivityIndex>
						<item>TheoryPapers</item>
						<baseAmount>1</baseAmount>
						<amountPerPawn>0</amountPerPawn>
						<spawnNearRitual>true</spawnNearRitual>
						<instaDrop>true</instaDrop>
						<forbid>false</forbid>
						<roofPunch>true</roofPunch>
					</li>
					<li Class="TPRitualAttachableOutcomes.RitualAttachableOutcomeEffectDef_TP_Custom_Node">
						<triggerPositivityIndex>
							<li>1</li>
						</triggerPositivityIndex>
						<item>TheoryPapers</item>
						<baseAmount>2</baseAmount>
						<amountPerPawn>0</amountPerPawn>
						<spawnNearRitual>true</spawnNearRitual>
						<instaDrop>true</instaDrop>
						<forbid>false</forbid>
						<roofPunch>true</roofPunch>
					</li>
					<li Class="TPRitualAttachableOutcomes.RitualAttachableOutcomeEffectDef_TP_Custom_Node">
						<triggerPositivityIndex>
							<li>2</li>
						</triggerPositivityIndex>
						<item>TheoryPapers</item>
						<baseAmount>3</baseAmount>
						<amountPerPawn>0</amountPerPawn>
						<spawnNearRitual>true</spawnNearRitual>
						<instaDrop>true</instaDrop>
						<forbid>false</forbid>
						<roofPunch>true</roofPunch>
					</li>
					<li Class="TPRitualAttachableOutcomes.RitualAttachableOutcomeEffectDef_TP_Custom_Node">
						<triggerPositivityIndex>
							<li>1</li>
							<li>2</li>
						</triggerPositivityIndex>
						<appliesTo>
							<li>TheoryResearcher</li>
						</appliesTo>
						<hediffToAdd>
							<li>TheoryInspirationHediff</li>
						</hediffToAdd>
					</li>
				</node>
			</li>
		</modExtensions>
	</RitualOutcomeEffectDef>
	  
</Defs>
