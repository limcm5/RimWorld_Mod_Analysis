<?xml version="1.0" encoding="utf-8" ?>
<Defs>

<ThingDef Class="MaruTrapArbitrarySetting.MaruTrapDamageDef" ParentName="BuildingBase">
    <defName>Trap_MRB</defName>
    <label>mechanical trap</label>
    <description>A more complex iron trap.\n\nIt does its job when hunting animals and in many other situations.</description>
    <thingClass>MaruTrapArbitrarySettingDamage.Building_TrapDamager</thingClass>
    <graphicData>	
      <texPath>Things/Trap/MR_Trap_B</texPath>
      <graphicClass>Graphic_Single</graphicClass>
      <drawSize>0.8</drawSize>
      <damageData>
        <rect>(0,0,1,0.15)</rect>
      </damageData>
    </graphicData>
    <altitudeLayer>Building</altitudeLayer>
    <rotatable>false</rotatable>
    <tickerType>Normal</tickerType>
    <stealable>false</stealable>
    <minifiedDef>MinifiedThing</minifiedDef>
    <thingCategories>
      <li>BuildingsSecurity</li>
    </thingCategories>
    <statBases>
      <Mass>2.5</Mass>
      <MaxHitPoints>15</MaxHitPoints>
      <WorkToBuild>3200</WorkToBuild>
      <Flammability>1</Flammability>
      <Beauty>-20</Beauty>
      <Cleanliness>-5</Cleanliness>
      <TrapMeleeDamage>15</TrapMeleeDamage>
      <TrapSpringChance>1.0</TrapSpringChance>
    </statBases>
    <building>
      <isTrap>true</isTrap>
      <trapDestroyOnSpring>true</trapDestroyOnSpring>
      <trapDamageCategory>Sharp</trapDamageCategory>
      <expandHomeArea>false</expandHomeArea>
      <ai_chillDestination>false</ai_chillDestination>
    </building>
    <placeWorkers>
      <li>PlaceWorker_NeverAdjacentTrap</li>
    </placeWorkers>
	<damageDef>MR_TrapDamage</damageDef>
    <rulePack>DamageEvent_MaruTrap</rulePack>
  </ThingDef>
  
	
	<ThingDef ParentName="ApparelBase"><!-- 덫 -->
		<defName>MR_Apparel_Trap</defName>
		<label>trap holder</label>
		<description>Equipment for carrying traps.</description>
		<descriptionHyperlinks>
			<ThingDef>Trap_MRB</ThingDef>
		</descriptionHyperlinks>
		<techLevel>Spacer</techLevel>
		<comps>
			<li Class="CompProperties_Reloadable">
				<maxCharges>5</maxCharges>
				<ammoDef>Steel</ammoDef>
				<ammoCountToRefill>27</ammoCountToRefill>
				<baseReloadTicks>60</baseReloadTicks>
				<soundReload>Standard_Reload</soundReload>
				<hotKey>Misc4</hotKey>
				<chargeNoun>Spare trap</chargeNoun>
				<displayGizmoWhileUndrafted>false</displayGizmoWhileUndrafted>
			</li>
		</comps>
			<verbs>
				<li>
					<verbClass>Verb_Spawn</verbClass>
					<label>Set Up mechanical Trap</label>
					<hasStandardCommand>true</hasStandardCommand>
					<spawnDef>Trap_MRB</spawnDef>
					<warmupTime>3.3</warmupTime>
					<range>1.9</range>
					<burstShotCount>1</burstShotCount>
					<soundAiming>AimingmarutrapSE_O</soundAiming>
					<targetParams>
						<canTargetLocations>true</canTargetLocations>
					</targetParams>
					<consumeFuelPerShot>1</consumeFuelPerShot>
					<targetable>true</targetable>
					<nonInterruptingSelfCast>true</nonInterruptingSelfCast>
					<onlyManualCast>true</onlyManualCast>
				</li>
			</verbs>
		<recipeMaker>
			<unfinishedThingDef>UnfinishedPack</unfinishedThingDef>
			<researchPrerequisite Inherit="False">Machining</researchPrerequisite>
			<recipeUsers>
        <li>ElectricSmithy</li>
        <li>FueledSmithy</li>
				<li>MR_retrofittable</li>
			</recipeUsers>
			<useIngredientsForColor>false</useIngredientsForColor>
			<workSpeedStat>GeneralLaborSpeed</workSpeedStat>
			<workSkill>Crafting</workSkill>
			<effectWorking>Smith</effectWorking>
			<soundWorking>Recipe_Smith</soundWorking>
			<skillRequirements>
				<Crafting>6</Crafting>
			</skillRequirements>
		</recipeMaker>
		<costList>
		    <Steel>20</Steel>
			<ComponentIndustrial>2</ComponentIndustrial>
		</costList>
		<graphicData>
			<texPath>Things/Trap/MR_Trap_W</texPath>
			<graphicClass>Graphic_Single</graphicClass>
		</graphicData>
		<tickerType>Normal</tickerType>
			<statBases>
				<WorkToMake>2200</WorkToMake>
				<Mass>3</Mass>
				<Flammability>0.4</Flammability>
				<EquipDelay>2</EquipDelay>
				<AccuracyTouch>1</AccuracyTouch>
				<AccuracyShort>1</AccuracyShort>
				<AccuracyMedium>1</AccuracyMedium>
				<AccuracyLong>1</AccuracyLong>
			</statBases>
				<thingCategories>
					<li>MRApparel</li>
				</thingCategories>
			<generateAllowChance>0</generateAllowChance>
		<apparel>
			<wornGraphicPath>Things/Inv/MR_Invisible</wornGraphicPath>
			<careIfWornByCorpse>false</careIfWornByCorpse>
			<careIfDamaged>false</careIfDamaged>
			<wearPerDay>0</wearPerDay>
			<bodyPartGroups>
				<li>Waist</li>
			</bodyPartGroups>
			<layers>
				<li>MRTrap</li>
			</layers>
		</apparel>
	</ThingDef>
	
	<DamageDef ParantName="Stab">
    <defName>MR_TrapDamage</defName>
    <label>caught in a trap</label>
    <workerClass>DamageWorker_stab</workerClass>
    <externalViolence>true</externalViolence>
    <deathMessage>{0} has been cut to death.</deathMessage>
    <hediff>Cut</hediff>
    <hediffSkin>Cut</hediffSkin>
    <hediffSolid>Crack</hediffSolid>
    <harmAllLayersUntilOutside>true</harmAllLayersUntilOutside>
    <impactSoundType>MarutrapSE_T2</impactSoundType>
    <armorCategory>Sharp</armorCategory>
    <overkillPctToDestroyPart>0~0.1</overkillPctToDestroyPart>
    <cutExtraTargetsCurve>
      <points>
        <li>0, 0</li>
        <li>0.6, 1</li>
        <li>0.9, 2</li>
        <li>1, 3</li>
      </points>
    </cutExtraTargetsCurve>
    <cutCleaveBonus>1.4</cutCleaveBonus>
   <additionalHediffs>
				<li>
					<hediff>MRH_TrapHediff</hediff>
					<severityPerDamageDealt>1</severityPerDamageDealt>
					<victimSeverityScalingByInvBodySize>true</victimSeverityScalingByInvBodySize>
				</li>
			</additionalHediffs>
  </DamageDef>
  
  <HediffDef>
		<defName>MRH_TrapHediff</defName>
		<hediffClass>HediffWithComps</hediffClass>
		<label>caught in a trap</label>
		<labelNoun>caught in a trap</labelNoun>
		<description>Trapped, temporarily slowing movement.</description>
		<defaultLabelColor>(0.7,0.3,0.3)</defaultLabelColor>
		<scenarioCanAdd>false</scenarioCanAdd>
		<maxSeverity>1.0</maxSeverity>
		<isBad>false</isBad>
		<comps>
			<li Class="HediffCompProperties_SeverityPerDay">
				<severityPerDay>-80</severityPerDay>
			</li>
      <li Class="HediffCompProperties_Effecter">
        <stateEffecter>MR_MoteMaruTrap</stateEffecter>
        <severityIndices>0~5</severityIndices>
      </li>
		</comps>
		<stages>
			<li>
                                <minSeverity>0</minSeverity>
				<statFactors>
                <MoveSpeed>-0.8</MoveSpeed>
				</statFactors>
	   <painFactor>1.3</painFactor>
			</li>

		</stages>
	</HediffDef>
	
	  <RulePackDef>
    <defName>DamageEvent_MaruTrap</defName>
    <include>
      <li>DamageEvent_Include</li>
    </include>
    <rulePack>
      <rulesStrings>
        <li>damage_source->[Beartrap] stabbed</li>
        <li>damage_source->[Beartrap] struck</li>
        <li>damage_source->[Beartrap] launched at</li>

        <li>Beartrap(p=3)->a mechanical trap</li>
        <li>Beartrap(p=3)->the mechanical trap</li>
        <li>Beartrap->fangs</li>
        <li>Beartrap->a sharp trap</li>
        <li>Beartrap->a spiky trap</li>

        <li>damaged_present->perforating</li>
        <li>damaged_present->spearing</li>
        <li>damaged_present->penetrating</li>
        <li>damaged_present->jabbing into</li>

        <li>destroyed_present->tearing apart</li>
        <li>destroyed_present->shredding</li>
        <li>destroyed_present->eviscerating</li>
        <li>destroyed_present->exploding</li>
      </rulesStrings>
    </rulePack>
  </RulePackDef>
	
	
<!--ㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇ-->


<ThingDef Class="MaruTrapArbitrarySetting.MaruTrapDamageDef" ParentName="BuildingBase">
    <defName>Trap_MRBA</defName>
    <label>Caltrop</label>
    <description>A simple iron trap.\n\nYou can block access effectively.</description>
    <thingClass>MaruTrapArbitrarySettingDamage.Building_TrapDamager</thingClass>
    <graphicData>	
      <texPath>Things/Trap/MR_TrapA_B</texPath>
      <graphicClass>Graphic_Single</graphicClass>
      <drawSize>0.8</drawSize>
      <damageData>
        <rect>(0,0,1,0.15)</rect>
      </damageData>
    </graphicData>
    <altitudeLayer>Building</altitudeLayer>
    <rotatable>false</rotatable>
    <tickerType>Normal</tickerType>
    <stealable>false</stealable>
    <minifiedDef>MinifiedThing</minifiedDef>
    <thingCategories>
      <li>BuildingsSecurity</li>
    </thingCategories>
    <statBases>
      <Mass>2.5</Mass>
      <MaxHitPoints>15</MaxHitPoints>
      <WorkToBuild>3200</WorkToBuild>
      <Flammability>1</Flammability>
      <Beauty>-20</Beauty>
      <Cleanliness>-5</Cleanliness>
      <TrapMeleeDamage>2</TrapMeleeDamage>
      <TrapSpringChance>1.0</TrapSpringChance>
    </statBases>
    <building>
      <isTrap>true</isTrap>
      <trapDestroyOnSpring>true</trapDestroyOnSpring>
      <trapDamageCategory>Sharp</trapDamageCategory>
      <expandHomeArea>false</expandHomeArea>
      <ai_chillDestination>false</ai_chillDestination>
    </building>
    <placeWorkers>
      <li>PlaceWorker_NeverAdjacentTrap</li>
    </placeWorkers>
	<damageDef>MR_TrapDamageA</damageDef>
    <rulePack>DamageEvent_MaruTrapA</rulePack>
  </ThingDef>
  
	
	<ThingDef ParentName="ApparelBase"><!-- 덫 -->
		<defName>MR_Apparel_TrapA</defName>
		<label>Caltrop box</label>
		<description>Equipment for carrying traps.</description>
		<descriptionHyperlinks>
			<ThingDef>Trap_MRBA</ThingDef>
		</descriptionHyperlinks>
		<techLevel>Spacer</techLevel>
		<comps>
			<li Class="CompProperties_Reloadable">
				<maxCharges>15</maxCharges>
				<ammoDef>Steel</ammoDef>
				<ammoCountToRefill>25</ammoCountToRefill>
				<baseReloadTicks>60</baseReloadTicks>
				<soundReload>Standard_Reload</soundReload>
				<hotKey>Misc4</hotKey>
				<chargeNoun>Spare trap</chargeNoun>
				<displayGizmoWhileUndrafted>false</displayGizmoWhileUndrafted>
			</li>
		</comps>
			<verbs>
				<li>
					<verbClass>Verb_Spawn</verbClass>
					<label>Set Up caltrop</label>
					<hasStandardCommand>true</hasStandardCommand>
					<spawnDef>Trap_MRBA</spawnDef>
					<warmupTime>0.9</warmupTime>
					<range>2.0</range>
					<burstShotCount>1</burstShotCount>
					<targetParams>
						<canTargetLocations>true</canTargetLocations>
					</targetParams>
					<consumeFuelPerShot>1</consumeFuelPerShot>
					<targetable>true</targetable>
					<nonInterruptingSelfCast>true</nonInterruptingSelfCast>
					<onlyManualCast>true</onlyManualCast>
				</li>
			</verbs>
		<recipeMaker>
			<unfinishedThingDef>UnfinishedPack</unfinishedThingDef>
			<researchPrerequisite Inherit="False">MaruRA2</researchPrerequisite>
			<recipeUsers>
        <li>ElectricSmithy</li>
        <li>FueledSmithy</li>
				<li>MR_retrofittable</li>
			</recipeUsers>
			<useIngredientsForColor>false</useIngredientsForColor>
			<workSpeedStat>GeneralLaborSpeed</workSpeedStat>
			<workSkill>Crafting</workSkill>
			<effectWorking>Smith</effectWorking>
			<soundWorking>Recipe_Smith</soundWorking>
			<skillRequirements>
				<Crafting>3</Crafting>
			</skillRequirements>
		</recipeMaker>
		<costList>
		    <WoodLog>20</WoodLog>
		    <Steel>8</Steel>
			<ComponentIndustrial>1</ComponentIndustrial>
		</costList>
		<graphicData>
			<texPath>Things/Trap/MR_TrapA_W</texPath>
			<graphicClass>Graphic_Single</graphicClass>
		</graphicData>
		<tickerType>Normal</tickerType>
			<statBases>
				<WorkToMake>2200</WorkToMake>
				<Mass>3</Mass>
				<Flammability>0.4</Flammability>
				<EquipDelay>2</EquipDelay>
				<AccuracyTouch>1</AccuracyTouch>
				<AccuracyShort>1</AccuracyShort>
				<AccuracyMedium>1</AccuracyMedium>
				<AccuracyLong>1</AccuracyLong>
			</statBases>
				<thingCategories>
					<li>MRApparel</li>
				</thingCategories>
			<generateAllowChance>0</generateAllowChance>
		<apparel>
			<wornGraphicPath>Things/Inv/MR_Invisible</wornGraphicPath>
			<careIfWornByCorpse>false</careIfWornByCorpse>
			<careIfDamaged>false</careIfDamaged>
			<wearPerDay>0</wearPerDay>
			<bodyPartGroups>
				<li>Waist</li>
			</bodyPartGroups>
			<layers>
				<li>MRTrap</li>
			</layers>
		</apparel>
	</ThingDef>
	
	<DamageDef ParantName="Stab">
    <defName>MR_TrapDamageA</defName>
    <label>caught in a trap</label>
    <workerClass>DamageWorker_stab</workerClass>
    <externalViolence>true</externalViolence>
    <deathMessage>{0} has been stabbed to death.</deathMessage>
    <hediff>Stab</hediff>
    <hediffSolid>Crack</hediffSolid>
    <harmAllLayersUntilOutside>true</harmAllLayersUntilOutside>
    <impactSoundType>Slice</impactSoundType> 
	<hediffSkin>Cut</hediffSkin>
    <armorCategory>Sharp</armorCategory>
    <overkillPctToDestroyPart>0~0.1</overkillPctToDestroyPart>
    <cutExtraTargetsCurve>
      <points>
        <li>0, 0</li>
        <li>0.6, 1</li>
        <li>0.9, 2</li>
        <li>1, 3</li>
      </points>
    </cutExtraTargetsCurve>
    <cutCleaveBonus>1.4</cutCleaveBonus>
   <additionalHediffs>
				<li>
					<hediff>MRH_TrapHediffA</hediff>
					<severityPerDamageDealt>1</severityPerDamageDealt>
					<victimSeverityScalingByInvBodySize>true</victimSeverityScalingByInvBodySize>
				</li>
			</additionalHediffs>
  </DamageDef>
  
  <HediffDef>
		<defName>MRH_TrapHediffA</defName>
		<hediffClass>HediffWithComps</hediffClass>
		<label>caught in a trap</label>
		<labelNoun>caught in a trap</labelNoun>
		<description>You are caught in a trap, temporarily slowing your movement.</description>
		<defaultLabelColor>(0.7,0.3,0.3)</defaultLabelColor>
		<scenarioCanAdd>false</scenarioCanAdd>
		<maxSeverity>1.0</maxSeverity>
		<isBad>false</isBad>
		<comps>
			<li Class="HediffCompProperties_SeverityPerDay">
				<severityPerDay>-80</severityPerDay>
			</li>
      <li Class="HediffCompProperties_Effecter">
        <stateEffecter>MR_MoteMaruTrapA</stateEffecter>
        <severityIndices>0~5</severityIndices>
      </li>
		</comps>
		<stages>
			<li>
                                <minSeverity>0</minSeverity>
				<statFactors>
                <MoveSpeed>-0.65</MoveSpeed>
				</statFactors>
			</li>

		</stages>
	</HediffDef>
	
	  <RulePackDef>
    <defName>DamageEvent_MaruTrapA</defName>
    <include>
      <li>DamageEvent_Include</li>
    </include>
    <rulePack>
      <rulesStrings>
        <li>damage_source->[Caltrop] stabbed</li>
        <li>damage_source->[Caltrop] struck</li>
        <li>damage_source->[Caltrop] launched at</li>

        <li>Caltrop(p=3)->a Caltrop</li>
        <li>Caltrop(p=3)->the Caltrop</li>
        <li>Caltrop->fangs</li>
        <li>Caltrop->a sharp trap</li>
        <li>Caltrop->a spiky trap</li>

        <li>damaged_present->perforating</li>
        <li>damaged_present->spearing</li>
        <li>damaged_present->penetrating</li>
        <li>damaged_present->jabbing into</li>

        <li>destroyed_present->tearing apart</li>
        <li>destroyed_present->shredding</li>
        <li>destroyed_present->eviscerating</li>
        <li>destroyed_present->exploding</li>
      </rulesStrings>
    </rulePack>
  </RulePackDef>
  
</Defs>